<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Lumina Studio â€” Professional Gradient Editor</title>
  <style>
    /* ---------- Design System ---------- */
    :root {
      --font-sans: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      --font-mono: 'JetBrains Mono', 'Fira Code', Consolas, monospace;

      /* Dark Theme (Default) */
      --bg-page: #09090b;
      --bg-panel: #18181b;
      --bg-surface: #27272a;
      
      --border-subtle: rgba(255,255,255,0.08);
      --border-focus: rgba(255,255,255,0.2);
      
      --text-main: #fafafa;
      --text-muted: #a1a1aa;
      --text-dim: #52525b;

      --primary: #6366f1;
      --primary-glow: rgba(99, 102, 241, 0.4);
      --accent: #ec4899;

      --radius-xl: 20px;
      --radius-lg: 12px;
      --radius-md: 8px;
      
      --shadow-sm: 0 1px 2px rgba(0,0,0,0.1);
      --shadow-lg: 0 20px 50px -12px rgba(0,0,0,0.5);
    }

    /* Light Theme Overrides */
    [data-theme="light"] {
      --bg-page: #f4f4f5;
      --bg-panel: #ffffff;
      --bg-surface: #f3f4f6;
      --border-subtle: rgba(0,0,0,0.08);
      --border-focus: rgba(0,0,0,0.2);
      --text-main: #18181b;
      --text-muted: #71717a;
      --text-dim: #d4d4d8;
      --shadow-lg: 0 20px 40px -12px rgba(0,0,0,0.1);
    }

    /* RTL Support for Arabic */
    [dir="rtl"] .brand { flex-direction: row-reverse; }
    [dir="rtl"] .row { flex-direction: row-reverse; }
    [dir="rtl"] .spread { flex-direction: row-reverse; }
    [dir="rtl"] .toolbar .row { flex-direction: row-reverse; }
    [dir="rtl"] .dropdown-menu { right: auto; left: 0; }
    [dir="rtl"] .code-floater { text-align: right; }
    [dir="rtl"] .sidebar-content { padding-left: 4px; padding-right: 0; }
    [dir="rtl"] .steps-strip { direction: ltr; } /* Keep gradient direction consistent */

    /* Prevent body scroll when modal is open */
    body.modal-open {
      overflow: hidden;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; outline: none; }
    
    body {
      background: var(--bg-page);
      color: var(--text-main);
      font-family: var(--font-sans);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      -webkit-font-smoothing: antialiased;
      transition: background 0.3s ease, color 0.3s ease;
    }

    /* Background Ambience */
    .ambience { position: fixed; inset: 0; z-index: -1; overflow: hidden; pointer-events: none; }
    .orb { position: absolute; border-radius: 50%; filter: blur(100px); opacity: 0.15; animation: float 20s infinite alternate cubic-bezier(0.4, 0, 0.2, 1); }
    .orb-1 { top: -10%; left: -10%; width: 50vw; height: 50vw; background: var(--primary); }
    .orb-2 { bottom: -10%; right: -10%; width: 40vw; height: 40vw; background: var(--accent); animation-delay: -5s; }
    @keyframes float { 0% { transform: translate(0,0); } 100% { transform: translate(50px, 30px); } }

    /* Layout & Grid */
    .app-container {
      max-width: 1600px;
      margin: 0 auto;
      padding: 20px;
      width: 100%;
      flex: 1;
      display: grid;
      grid-template-columns: 340px 1fr;
      gap: 24px;
      height: 100vh;
      max-height: 100vh;
    }

    @media (max-width: 1024px) {
      .app-container { grid-template-columns: 1fr; height: auto; max-height: none; }
    }

    /* Panels */
    .panel {
      background: var(--bg-panel);
      border: 1px solid var(--border-subtle);
      border-radius: var(--radius-xl);
      padding: 20px;
      display: flex;
      flex-direction: column;
      gap: 20px;
      box-shadow: var(--shadow-sm);
    }

    /* Typography */
    h2 { font-size: 0.75rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.08em; font-weight: 600; margin-bottom: 8px; }
    label { font-size: 0.85rem; color: var(--text-muted); display: block; margin-bottom: 6px; font-weight: 500; }
    
    /* Header/Nav */
    header { display: flex; align-items: center; justify-content: space-between; padding-bottom: 20px; border-bottom: 1px solid var(--border-subtle); margin-bottom: 4px; }
    .brand { display: flex; align-items: center; gap: 10px; }
    .logo-box { width: 32px; height: 32px; background: linear-gradient(135deg, var(--primary), var(--accent)); border-radius: 8px; display: flex; align-items: center; justify-content: center; color: white; font-weight: 800; font-size: 14px; }
    .brand h1 { font-size: 16px; font-weight: 700; }
    
    /* Language Toggle Button */
    .lang-toggle {
      background: transparent;
      border: 1px solid var(--border-subtle);
      color: var(--text-muted);
      padding: 4px 12px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 0.75rem;
      margin-left: 8px;
      transition: all 0.2s;
    }
    .lang-toggle:hover {
      background: var(--bg-surface);
      color: var(--text-main);
    }
    
    /* Language Dropdown */
    .lang-dropdown-container {
      position: relative;
      display: inline-block;
    }
    
    .lang-dropdown-menu {
      position: absolute;
      top: 100%;
      right: 0;
      margin-top: 8px;
      width: 180px;
      background: var(--bg-panel);
      border: 1px solid var(--border-subtle);
      border-radius: var(--radius-lg);
      padding: 6px;
      box-shadow: var(--shadow-lg);
      display: none;
      z-index: 150;
    }
    
    .lang-dropdown-menu.show {
      display: block;
      animation: fadeIn 0.15s ease;
    }
    
    .lang-option {
      display: block;
      width: 100%;
      text-align: left;
      padding: 8px 12px;
      background: transparent;
      border: none;
      color: var(--text-main);
      border-radius: 6px;
      cursor: pointer;
      font-size: 0.9rem;
    }
    
    .lang-option:hover {
      background: var(--bg-surface);
    }
    
    .lang-option.active {
      background: var(--primary);
      color: white;
    }

    /* Buttons */
    .btn {
      display: inline-flex; align-items: center; justify-content: center; gap: 8px;
      padding: 0 16px; height: 36px;
      border-radius: var(--radius-md);
      font-size: 0.85rem; font-weight: 500;
      cursor: pointer; transition: all 0.2s;
      border: 1px solid transparent;
    }
    .btn-primary {
      background: var(--text-main); color: var(--bg-page);
    }
    .btn-primary:hover { transform: translateY(-1px); box-shadow: 0 4px 12px rgba(255,255,255,0.15); }
    
    .btn-ghost {
      background: transparent; border: 1px solid var(--border-subtle); color: var(--text-main);
    }
    .btn-ghost:hover { border-color: var(--text-muted); background: var(--bg-surface); }
    
    .btn-icon { padding: 0; width: 32px; height: 32px; border-radius: 6px; border: none; background: transparent; color: var(--text-muted); cursor: pointer; }
    .btn-icon:hover { background: var(--bg-surface); color: var(--text-main); }

    /* Inputs */
    input[type="text"], select {
      width: 100%; height: 36px; padding: 0 12px;
      background: var(--bg-surface); border: 1px solid var(--border-subtle);
      border-radius: var(--radius-md); color: var(--text-main);
      font-family: var(--font-sans); font-size: 0.9rem;
      transition: border 0.2s;
    }
    input[type="text"]:focus, select:focus { border-color: var(--primary); }
    
    .hex-input { font-family: var(--font-mono); text-transform: uppercase; letter-spacing: 0.5px; }

    /* Custom Range Slider */
    input[type=range] {
      -webkit-appearance: none; width: 100%; background: transparent; margin: 10px 0;
    }
    input[type=range]::-webkit-slider-thumb {
      -webkit-appearance: none; height: 16px; width: 16px; border-radius: 50%;
      background: var(--text-main); cursor: pointer; margin-top: -6px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.2);
    }
    input[type=range]::-webkit-slider-runnable-track {
      width: 100%; height: 4px; cursor: pointer; background: var(--bg-surface); border-radius: 2px; border: 1px solid var(--border-subtle);
    }

    /* Steps controls with buttons */
    .steps-controls {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-top: 8px;
    }
    
    .step-btn {
      width: 32px;
      height: 32px;
      border-radius: 6px;
      background: var(--bg-surface);
      border: 1px solid var(--border-subtle);
      color: var(--text-main);
      font-size: 18px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s;
    }
    
    .step-btn:hover {
      background: var(--primary);
      border-color: var(--primary);
      color: white;
    }
    
    .step-btn:active {
      transform: scale(0.95);
    }
    
    .steps-slider-container {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    /* Scrollable Sidebar */
    .sidebar-content { overflow-y: auto; padding-right: 4px; display: flex; flex-direction: column; gap: 24px; max-height: calc(100vh - 120px); }
    
    /* Color List */
    .color-stack { display: flex; flex-direction: column; gap: 8px; }
    .color-row {
      display: flex; align-items: center; gap: 10px;
      background: var(--bg-surface); padding: 6px; border-radius: var(--radius-md);
      border: 1px solid transparent; transition: all 0.2s;
    }
    .color-row:hover { border-color: var(--border-subtle); transform: translateX(2px); }
    
    .color-preview {
      width: 36px; height: 36px; border-radius: 6px;
      position: relative; overflow: hidden;
      box-shadow: inset 0 0 0 1px rgba(0,0,0,0.1);
      flex-shrink: 0;
    }
    .color-picker-trigger { position: absolute; inset: -4px; width: 150%; height: 150%; opacity: 0; cursor: pointer; }

    /* Base Color Preview FIX */
    .base-color-preview {
      width: 40px;
      height: 36px;
      border-radius: 6px;
      position: relative;
      overflow: hidden;
      box-shadow: inset 0 0 0 1px rgba(0,0,0,0.1);
      flex-shrink: 0;
    }
    .base-color-picker-trigger {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      opacity: 0;
      cursor: pointer;
    }

    /* Main Preview Area - Changed to strips */
    .preview-section {
      display: flex; flex-direction: column; gap: 16px; height: 100%;
    }
    
    .toolbar { display: flex; justify-content: space-between; align-items: center; }

    .canvas-wrapper {
      flex: 1;
      background-color: var(--bg-surface);
      /* Checkerboard pattern for transparency */
      background-image:
        linear-gradient(45deg, #1f1f22 25%, transparent 25%),
        linear-gradient(-45deg, #1f1f22 25%, transparent 25%),
        linear-gradient(45deg, transparent 75%, #1f1f22 75%),
        linear-gradient(-45deg, transparent 75%, #1f1f22 75%);
      background-size: 20px 20px;
      background-position: 0 0, 0 10px, 10px -10px, -10px 0px;
      border-radius: var(--radius-lg);
      border: 1px solid var(--border-subtle);
      position: relative;
      overflow: hidden;
      min-height: 400px;
      box-shadow: inset 0 0 40px rgba(0,0,0,0.2);
    }
    [data-theme="light"] .canvas-wrapper {
      background-image:
        linear-gradient(45deg, #e4e4e7 25%, transparent 25%),
        linear-gradient(-45deg, #e4e4e7 25%, transparent 25%),
        linear-gradient(45deg, transparent 75%, #e4e4e7 75%),
        linear-gradient(-45deg, transparent 75%, #e4e4e7 75%);
    }

    #previewBox { 
      width: 100%; 
      height: 100%; 
      display: flex;
      flex-direction: row;
      transition: background 0.1s linear;
    }
    
    .preview-strip {
      flex: 1;
      height: 100%;
      transition: background-color 0.1s ease;
      position: relative;
    }
    
    .preview-strip:hover::after {
      content: attr(data-color);
      position: absolute;
      bottom: 5px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(0,0,0,0.7);
      color: white;
      padding: 2px 6px;
      border-radius: 4px;
      font-size: 0.7rem;
      font-family: var(--font-mono);
      z-index: 10;
    }

    .code-floater {
      position: absolute; bottom: 20px; left: 20px; right: 20px;
      background: rgba(15, 15, 17, 0.85); backdrop-filter: blur(12px);
      padding: 12px 16px; border-radius: 12px;
      border: 1px solid rgba(255,255,255,0.1);
      display: flex; justify-content: space-between; align-items: center;
      color: var(--text-main); font-family: var(--font-mono); font-size: 0.85rem;
      box-shadow: 0 8px 32px rgba(0,0,0,0.3);
      cursor: pointer; transition: transform 0.2s;
    }
    .code-floater:hover { transform: translateY(-2px); border-color: rgba(255,255,255,0.2); }
    
    /* Steps/Breakdown Strip */
    .steps-strip {
      height: 48px;
      display: flex;
      border-radius: var(--radius-md);
      overflow: hidden;
      border: 1px solid var(--border-subtle);
      cursor: crosshair;
    }
    .step-unit { flex: 1; transition: opacity 0.1s; }
    .step-unit:hover { opacity: 0.8; }

    /* Modals */
    .modal-overlay {
      position: fixed; inset: 0; background: rgba(0,0,0,0.6); backdrop-filter: blur(4px);
      z-index: 100; display: none; align-items: center; justify-content: center;
      opacity: 0; transition: opacity 0.2s;
    }
    .modal-overlay.active { display: flex; opacity: 1; }
    
    .modal-card {
      background: var(--bg-panel); border: 1px solid var(--border-subtle);
      border-radius: var(--radius-xl); width: 90%; max-width: 900px;
      max-height: 85vh; overflow: hidden; display: flex; flex-direction: column;
      box-shadow: var(--shadow-lg); transform: scale(0.95); transition: transform 0.2s;
    }
    .modal-overlay.active .modal-card { transform: scale(1); }
    
    .modal-header { padding: 20px; border-bottom: 1px solid var(--border-subtle); display: flex; justify-content: space-between; align-items: center; }
    .modal-body { padding: 20px; overflow-y: auto; }
    
    .preset-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 16px; }
    .preset-item {
      border: 1px solid var(--border-subtle); border-radius: var(--radius-lg); overflow: hidden;
      cursor: pointer; transition: transform 0.2s, border-color 0.2s; background: var(--bg-surface);
    }
    .preset-item:hover { transform: translateY(-4px); border-color: var(--text-muted); }
    .preset-preview { 
      height: 100px; 
      width: 100%; 
      display: flex;
      flex-direction: row;
    }
    .preset-strip {
      flex: 1;
      height: 100%;
    }
    .preset-info { padding: 12px; font-weight: 500; font-size: 0.9rem; }
    
    /* User Gradients Section */
    .user-gradients-section {
      margin-top: 24px;
    }
    
    .user-gradients-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 16px;
      margin-top: 12px;
    }
    
    .save-gradient-btn {
      margin-top: 12px;
      width: 100%;
    }

    /* Toast */
    .toast {
      position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%) translateY(20px);
      background: var(--text-main); color: var(--bg-page);
      padding: 10px 24px; border-radius: 50px; font-weight: 600;
      opacity: 0; transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      pointer-events: none; z-index: 200; box-shadow: 0 10px 30px rgba(0,0,0,0.2);
    }
    .toast.show { transform: translateX(-50%) translateY(0); opacity: 1; }

    /* Utility */
    .control-group { background: var(--bg-surface); padding: 16px; border-radius: var(--radius-lg); border: 1px solid var(--border-subtle); }
    .row { display: flex; gap: 10px; align-items: center; }
    .spread { display: flex; justify-content: space-between; align-items: center; }
    .muted { color: var(--text-muted); font-size: 0.8rem; }
    
    /* Toggle Switch */
    .toggle { appearance: none; width: 40px; height: 22px; background: var(--bg-panel); border: 1px solid var(--border-subtle); border-radius: 20px; position: relative; cursor: pointer; transition: 0.3s; }
    .toggle::after { content: ''; position: absolute; top: 2px; left: 2px; width: 16px; height: 16px; background: var(--text-muted); border-radius: 50%; transition: 0.3s; }
    .toggle:checked { background: var(--primary); border-color: var(--primary); }
    .toggle:checked::after { transform: translateX(18px); background: #fff; }

    /* Dropdown Menu */
    .dropdown-container { position: relative; }
    .dropdown-menu {
      position: absolute; top: 100%; right: 0; margin-top: 8px; width: 200px;
      background: var(--bg-panel); border: 1px solid var(--border-subtle);
      border-radius: var(--radius-lg); padding: 6px; box-shadow: var(--shadow-lg);
      display: none; z-index: 50;
    }
    .dropdown-menu.show { display: block; animation: fadeIn 0.15s ease; }
    .menu-item {
      display: block; width: 100%; text-align: left; padding: 8px 12px;
      background: transparent; border: none; color: var(--text-main);
      border-radius: 6px; cursor: pointer; font-size: 0.9rem;
    }
    .menu-item:hover { background: var(--bg-surface); }
    
    @keyframes fadeIn { from{opacity:0;transform:translateY(-5px)} to{opacity:1;transform:translateY(0)} }
  </style>
</head>
<body data-theme="dark" dir="ltr">

  <div class="ambience">
    <div class="orb orb-1"></div>
    <div class="orb orb-2"></div>
  </div>

  <main class="app-container">
    
    <aside class="panel">
      <header>
        <div class="brand">
          <div class="logo-box">LS</div>
          <h1 data-i18n="appTitle">Lumina Studio</h1>
        </div>
        <div style="display: flex; gap: 8px;">
          <div class="lang-dropdown-container">
            <button id="langToggle" class="lang-toggle" title="Toggle Language">ğŸŒ EN</button>
            <div id="langDropdown" class="lang-dropdown-menu">
              <button data-lang="en" class="lang-option active">ğŸ‡ºğŸ‡¸ English</button>
              <button data-lang="ar" class="lang-option">ğŸ‡¸ğŸ‡¦ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</button>
              <button data-lang="fr" class="lang-option">ğŸ‡«ğŸ‡· FranÃ§ais</button>
              <button data-lang="es" class="lang-option">ğŸ‡ªğŸ‡¸ EspaÃ±ol</button>
              <button data-lang="de" class="lang-option">ğŸ‡©ğŸ‡ª Deutsch</button>
              <button data-lang="zh" class="lang-option">ğŸ‡¨ğŸ‡³ ä¸­æ–‡</button>
              <button data-lang="ja" class="lang-option">ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª</button>
              <button data-lang="ru" class="lang-option">ğŸ‡·ğŸ‡º Ğ ÑƒÑÑĞºĞ¸Ğ¹</button>
              <button data-lang="tr" class="lang-option">ğŸ‡¹ğŸ‡· TÃ¼rkÃ§e</button>
              <button data-lang="pt" class="lang-option">ğŸ‡µğŸ‡¹ PortuguÃªs</button>
              <button data-lang="hi" class="lang-option">ğŸ‡®ğŸ‡³ à¤¹à¤¿à¤¨à¥à¤¦à¥€</button>
              <button data-lang="ko" class="lang-option">ğŸ‡°ğŸ‡· í•œêµ­ì–´</button>
              <button data-lang="it" class="lang-option">ğŸ‡®ğŸ‡¹ Italiano</button>
            </div>
          </div>
          <button id="themeToggle" class="btn-icon" title="Toggle Theme">
            <svg width="20" height="20" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" /></svg>
          </button>
        </div>
      </header>

      <div class="sidebar-content">
        <section>
          <div class="spread" style="margin-bottom:8px">
            <h2 data-i18n="smartGenerator">Harmony Generator</h2>
          </div>
          <div class="control-group">
            <label data-i18n="baseColor">Base Color</label>
            <div class="row" style="margin-bottom:12px">
              <div class="base-color-preview" id="baseColorPreview" style="background-color: #6366F1;">
                <input id="genBaseColor" type="color" value="#6366f1" class="base-color-picker-trigger">
              </div>
              <input id="genBaseHex" type="text" value="#6366F1" class="hex-input">
            </div>
            
            <label data-i18n="harmonyMode">Color Count</label>
            <select id="genMode" style="margin-bottom:12px">
              <option value="random" data-i18n="randomCount">Random (2-5)</option>
              <option value="2" data-i18n="twoColors">2 Colors</option>
              <option value="3" selected data-i18n="threeColors">3 Colors</option>
              <option value="4" data-i18n="fourColors">4 Colors</option>
              <option value="5" data-i18n="fiveColors">5 Colors</option>
            </select>
            
            <label style="margin-top:12px" data-i18n="basePosition">Base Color Position</label>
            <select id="basePosition" style="margin-bottom:12px">
              <option value="start" selected data-i18n="atStart">At Start</option>
              <option value="end" data-i18n="atEnd">At End</option>
              <option value="middle" data-i18n="inMiddle">In Middle</option>
              <option value="random" data-i18n="randomPosition">Random</option>
            </select>
            
            <button id="btnSmartGenerate" class="btn btn-primary" style="width:100%" data-i18n="generatePalette">Generate New Harmony</button>
          </div>
        </section>

        <section>
          <div class="spread" style="margin-bottom:8px">
            <h2 data-i18n="colorStops">Color Stops</h2>
            <div style="display:flex; gap:8px">
               <button id="btnRandom" class="btn-icon" title="Randomize All" data-i18n-title="randomize">ğŸ²</button>
               <button id="btnAddColor" class="btn-icon" title="Add Stop" data-i18n-title="addStop">â•</button>
            </div>
          </div>
          
          <div id="colorList" class="color-stack">
            </div>
        </section>

        <section>
           <h2 data-i18n="configuration">Configuration</h2>
           <div class="control-group">
             <div class="spread">
               <label data-i18n="stepsPrecision">Steps / Precision</label>
               <span id="stepsVal" class="muted font-mono">15</span>
             </div>
             
             <div class="steps-controls">
               <button id="stepsDecrease" class="step-btn">âˆ’</button>
               <div class="steps-slider-container">
                 <input id="stepsInput" type="range" min="2" max="100" value="15">
               </div>
               <button id="stepsIncrease" class="step-btn">+</button>
             </div>

             <div class="spread" style="margin-top:16px">
               <label for="checkVivid" style="margin:0; cursor:pointer" data-i18n="vividMode">Vivid Mode (LAB)</label>
               <input id="checkVivid" type="checkbox" class="toggle">
             </div>
             <p class="muted" style="margin-top:8px; font-size:0.75rem; line-height:1.4" data-i18n="vividDescription">Perceptually uniform interpolation preventing "gray dead zones" in gradients.</p>
           </div>
        </section>
      </div>
    </aside>

    <section class="preview-section">
      <div class="toolbar">
        <div class="row">
          <button id="openPresetsBtn" class="btn btn-ghost" data-i18n="gallery">Gallery</button>
          <button id="openBreakdownBtn" class="btn btn-ghost" data-i18n="analyze">Analyze</button>
          <button id="saveGradientBtn" class="btn btn-ghost" data-i18n="saveGradient">Save Gradient</button>
        </div>
        
        <div class="dropdown-container">
          <button id="btnExportToggle" class="btn btn-primary" data-i18n="downloadExport">Download / Export</button>
          <div id="exportMenu" class="dropdown-menu">
             <button id="actCopyCSS" class="menu-item" data-i18n="copyCSS">ğŸ“‹ Copy CSS</button>
             <button id="actCopyTailwind" class="menu-item" data-i18n="copyTailwind">ğŸ’¨ Copy Tailwind</button>
             <hr style="border:0; border-top:1px solid var(--border-subtle); margin:4px 0">
             <button id="actDownloadCSS" class="menu-item" data-i18n="downloadCSS">ğŸ“„ Download .CSS</button>
             <button id="actDownloadPNG" class="menu-item" data-i18n="downloadPNG">ğŸ–¼ï¸ Download .PNG</button>
          </div>
        </div>
      </div>

      <div class="canvas-wrapper">
        <div id="previewBox" role="img" aria-label="Gradient Preview"></div>
        <div class="code-floater" id="cssPreviewTrigger" title="Click to copy" data-i18n-title="clickToCopy">
          <span id="cssPreviewText" style="opacity:0.8">linear-gradient(...)</span>
          <span style="opacity:0.5; font-size:0.75rem; margin-left:12px" data-i18n="clickToCopy">CLICK TO COPY</span>
        </div>
      </div>

      <div>
        <div class="spread" style="margin-bottom:8px">
          <h2 data-i18n="gradientSpectrum">Gradient Spectrum</h2>
          <span class="muted" style="font-size:0.75rem" data-i18n="spectrumHint">Hover to identify, click to copy</span>
        </div>
        <div id="stepsGrid" class="steps-strip"></div>
      </div>
    </section>

  </main>

  <div id="presetsModal" class="modal-overlay">
    <div class="modal-card">
      <div class="modal-header">
        <h3 data-i18n="gradientGallery">Gradient Gallery</h3>
        <button class="btn-icon close-modal">âœ•</button>
      </div>
      <div class="modal-body">
        <h4 style="margin-bottom: 12px;" data-i18n="builtinGradients">Built-in Gradients</h4>
        <div id="presetsGrid" class="preset-grid"></div>
        
        <div class="user-gradients-section">
          <div class="spread">
            <h4 style="margin-bottom: 12px;" data-i18n="mySavedGradients">My Saved Gradients</h4>
            <button id="clearSavedGradients" class="btn btn-ghost btn-small" style="font-size: 0.75rem;" data-i18n="clearAll">Clear All</button>
          </div>
          <div id="userGradientsGrid" class="user-gradients-grid">
            <!-- User saved gradients will appear here -->
          </div>
        </div>
      </div>
    </div>
  </div>

  <div id="breakdownModal" class="modal-overlay">
    <div class="modal-card" style="max-width:600px">
      <div class="modal-header">
        <h3 data-i18n="colorAnalysis">Color Analysis</h3>
        <button class="btn-icon close-breakdown">âœ•</button>
      </div>
      <div class="modal-body">
        <div id="breakGrid" style="display:grid; grid-template-columns:repeat(auto-fill, minmax(60px,1fr)); gap:8px"></div>
      </div>
    </div>
  </div>

  <div id="toast" class="toast">Action Complete</div>
  <canvas id="exportCanvas" style="display:none"></canvas>

  <script>
    /* ---------- Application State ---------- */
    const state = {
      colors: ['#6366F1','#A855F7','#EC4899'],
      steps: 15,
      vivid: false,
      theme: 'dark',
      generated: [],
      language: 'en',
      userGradients: JSON.parse(localStorage.getItem('luminaUserGradients') || '[]'),
      lastHarmonySeed: 0
    };

    const DOM = {
      colorList: document.getElementById('colorList'),
      stepsSlider: document.getElementById('stepsInput'),
      stepsVal: document.getElementById('stepsVal'),
      stepsDecrease: document.getElementById('stepsDecrease'),
      stepsIncrease: document.getElementById('stepsIncrease'),
      vividFlag: document.getElementById('checkVivid'),
      genBase: document.getElementById('genBaseColor'),
      genHex: document.getElementById('genBaseHex'),
      genMode: document.getElementById('genMode'),
      basePosition: document.getElementById('basePosition'),
      btnGen: document.getElementById('btnSmartGenerate'),
      btnAdd: document.getElementById('btnAddColor'),
      btnRandom: document.getElementById('btnRandom'),
      preview: document.getElementById('previewBox'),
      cssText: document.getElementById('cssPreviewText'),
      cssTrigger: document.getElementById('cssPreviewTrigger'),
      strip: document.getElementById('stepsGrid'),
      // Export
      exportToggle: document.getElementById('btnExportToggle'),
      exportMenu: document.getElementById('exportMenu'),
      actions: {
        css: document.getElementById('actCopyCSS'),
        tw: document.getElementById('actCopyTailwind'),
        dlCss: document.getElementById('actDownloadCSS'),
        dlPng: document.getElementById('actDownloadPNG')
      },
      // Modals
      presetsBtn: document.getElementById('openPresetsBtn'),
      presetsModal: document.getElementById('presetsModal'),
      presetsGrid: document.getElementById('presetsGrid'),
      breakdownBtn: document.getElementById('openBreakdownBtn'),
      breakdownModal: document.getElementById('breakdownModal'),
      breakGrid: document.getElementById('breakGrid'),
      // User Gradients
      saveGradientBtn: document.getElementById('saveGradientBtn'),
      userGradientsGrid: document.getElementById('userGradientsGrid'),
      clearSavedGradients: document.getElementById('clearSavedGradients'),
      // Utils
      toast: document.getElementById('toast'),
      canvas: document.getElementById('exportCanvas'),
      themeToggle: document.getElementById('themeToggle'),
      langToggle: document.getElementById('langToggle'),
      langDropdown: document.getElementById('langDropdown'),
      langOptions: document.querySelectorAll('.lang-option'),
      body: document.body,
      baseColorPreview: document.getElementById('baseColorPreview')
    };

    /* ---------- Language Support ---------- */
    const translations = {
      en: {
        appTitle: "Lumina Studio",
        smartGenerator: "Harmony Generator",
        baseColor: "Base Color",
        harmonyMode: "Color Count",
        generatePalette: "Generate New Harmony",
        colorStops: "Color Stops",
        randomize: "Randomize All",
        addStop: "Add Stop",
        configuration: "Configuration",
        stepsPrecision: "Steps / Precision",
        vividMode: "Vivid Mode (LAB)",
        vividDescription: "Perceptually uniform interpolation preventing 'gray dead zones' in gradients.",
        gallery: "Gallery",
        analyze: "Analyze",
        saveGradient: "Save Gradient",
        downloadExport: "Download / Export",
        copyCSS: "ğŸ“‹ Copy CSS",
        copyTailwind: "ğŸ’¨ Copy Tailwind",
        downloadCSS: "ğŸ“„ Download .CSS",
        downloadPNG: "ğŸ–¼ï¸ Download .PNG",
        gradientSpectrum: "Gradient Spectrum",
        spectrumHint: "Hover to identify, click to copy",
        gradientGallery: "Gradient Gallery",
        colorAnalysis: "Color Analysis",
        clickToCopy: "CLICK TO COPY",
        clickToCopyTitle: "Click to copy",
        randomCount: "Random (2-5)",
        twoColors: "2 Colors",
        threeColors: "3 Colors",
        fourColors: "4 Colors",
        fiveColors: "5 Colors",
        basePosition: "Base Color Position",
        atStart: "At Start",
        atEnd: "At End",
        inMiddle: "In Middle",
        randomPosition: "Random",
        builtinGradients: "Built-in Gradients",
        mySavedGradients: "My Saved Gradients",
        clearAll: "Clear All"
      },
      ar: {
        appTitle: "Lumina Studio",
        smartGenerator: "Ù…ÙˆÙ„Ø¯ Ø§Ù„ØªÙ†Ø§ØºÙ…",
        baseColor: "Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ",
        harmonyMode: "Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ù„ÙˆØ§Ù†",
        generatePalette: "Ø¥Ù†Ø´Ø§Ø¡ ØªÙ†Ø§ØºÙ… Ø¬Ø¯ÙŠØ¯",
        colorStops: "Ù†Ù‚Ø§Ø· Ø§Ù„Ø£Ù„ÙˆØ§Ù†",
        randomize: "Ø¹Ø´ÙˆØ§Ø¦ÙŠ ÙƒÙ„ÙŠ",
        addStop: "Ø¥Ø¶Ø§ÙØ© Ù†Ù‚Ø·Ø©",
        configuration: "Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª",
        stepsPrecision: "Ø§Ù„Ø®Ø·ÙˆØ§Øª / Ø§Ù„Ø¯Ù‚Ø©",
        vividMode: "Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø­ÙŠÙˆÙŠ (LAB)",
        vividDescription: "Ø§Ø³ØªÙŠÙØ§Ø¡ Ù…ÙˆØ­Ø¯ Ø¥Ø¯Ø±Ø§ÙƒÙŠØ§Ù‹ ÙŠÙ…Ù†Ø¹ 'Ø§Ù„Ù…Ù†Ø§Ø·Ù‚ Ø§Ù„Ø±Ù…Ø§Ø¯ÙŠØ© Ø§Ù„Ù…ÙŠØªØ©' ÙÙŠ Ø§Ù„ØªØ¯Ø±Ø¬Ø§Øª.",
        gallery: "Ø§Ù„Ù…Ø¹Ø±Ø¶",
        analyze: "ØªØ­Ù„ÙŠÙ„",
        saveGradient: "Ø­ÙØ¸ Ø§Ù„ØªØ¯Ø±Ø¬",
        downloadExport: "ØªÙ†Ø²ÙŠÙ„ / ØªØµØ¯ÙŠØ±",
        copyCSS: "ğŸ“‹ Ù†Ø³Ø® CSS",
        copyTailwind: "ğŸ’¨ Ù†Ø³Ø® Tailwind",
        downloadCSS: "ğŸ“„ ØªÙ†Ø²ÙŠÙ„ .CSS",
        downloadPNG: "ğŸ–¼ï¸ ØªÙ†Ø²ÙŠÙ„ .PNG",
        gradientSpectrum: "Ø·ÙŠÙ Ø§Ù„ØªØ¯Ø±Ø¬",
        spectrumHint: "Ù…Ø±Ø± Ù„Ù„ØªØ­Ø¯ÙŠØ¯ØŒ Ø§Ù†Ù‚Ø± Ù„Ù„Ù†Ø³Ø®",
        gradientGallery: "Ù…Ø¹Ø±Ø¶ Ø§Ù„ØªØ¯Ø±Ø¬Ø§Øª",
        colorAnalysis: "ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø£Ù„ÙˆØ§Ù†",
        clickToCopy: "Ø§Ù†Ù‚Ø± Ù„Ù„Ù†Ø³Ø®",
        clickToCopyTitle: "Ø§Ù†Ù‚Ø± Ù„Ù„Ù†Ø³Ø®",
        randomCount: "Ø¹Ø´ÙˆØ§Ø¦ÙŠ (2-5)",
        twoColors: "Ù„ÙˆÙ†ÙŠÙ†",
        threeColors: "3 Ø£Ù„ÙˆØ§Ù†",
        fourColors: "4 Ø£Ù„ÙˆØ§Ù†",
        fiveColors: "5 Ø£Ù„ÙˆØ§Ù†",
        basePosition: "Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ",
        atStart: "ÙÙŠ Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©",
        atEnd: "ÙÙŠ Ø§Ù„Ù†Ù‡Ø§ÙŠØ©",
        inMiddle: "ÙÙŠ Ø§Ù„Ù…Ù†ØªØµÙ",
        randomPosition: "Ø¹Ø´ÙˆØ§Ø¦ÙŠ",
        builtinGradients: "Ø§Ù„ØªØ¯Ø±Ø¬Ø§Øª Ø§Ù„Ù…Ø¶Ù…Ù†Ø©",
        mySavedGradients: "ØªØ¯Ø±Ø¬Ø§ØªÙŠ Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©",
        clearAll: "Ù…Ø³Ø­ Ø§Ù„ÙƒÙ„"
      },
      fr: {
        appTitle: "Lumina Studio",
        smartGenerator: "GÃ©nÃ©rateur d'Harmonie",
        baseColor: "Couleur de Base",
        harmonyMode: "Nombre de Couleurs",
        generatePalette: "GÃ©nÃ©rer une Nouvelle Harmonie",
        colorStops: "Points de Couleur",
        randomize: "Tout AlÃ©atoire",
        addStop: "Ajouter un Point",
        configuration: "Configuration",
        stepsPrecision: "Ã‰tapes / PrÃ©cision",
        vividMode: "Mode Vif (LAB)",
        vividDescription: "Interpolation uniforme perceptuellement Ã©vitant les 'zones grises mortes' dans les dÃ©gradÃ©s.",
        gallery: "Galerie",
        analyze: "Analyser",
        saveGradient: "Enregistrer le DÃ©gradÃ©",
        downloadExport: "TÃ©lÃ©charger / Exporter",
        copyCSS: "ğŸ“‹ Copier CSS",
        copyTailwind: "ğŸ’¨ Copier Tailwind",
        downloadCSS: "ğŸ“„ TÃ©lÃ©charger .CSS",
        downloadPNG: "ğŸ–¼ï¸ TÃ©lÃ©charger .PNG",
        gradientSpectrum: "Spectre du DÃ©gradÃ©",
        spectrumHint: "Survoler pour identifier, cliquer pour copier",
        gradientGallery: "Galerie de DÃ©gradÃ©s",
        colorAnalysis: "Analyse des Couleurs",
        clickToCopy: "CLIQUER POUR COPIER",
        clickToCopyTitle: "Cliquer pour copier",
        randomCount: "AlÃ©atoire (2-5)",
        twoColors: "2 Couleurs",
        threeColors: "3 Couleurs",
        fourColors: "4 Couleurs",
        fiveColors: "5 Couleurs",
        basePosition: "Position de la Couleur de Base",
        atStart: "Au DÃ©but",
        atEnd: "Ã€ la Fin",
        inMiddle: "Au Milieu",
        randomPosition: "AlÃ©atoire",
        builtinGradients: "DÃ©gradÃ©s IntÃ©grÃ©s",
        mySavedGradients: "Mes DÃ©gradÃ©s EnregistrÃ©s",
        clearAll: "Tout Effacer"
      },
      es: {
        appTitle: "Lumina Studio",
        smartGenerator: "Generador de ArmonÃ­a",
        baseColor: "Color Base",
        harmonyMode: "Cantidad de Colores",
        generatePalette: "Generar Nueva ArmonÃ­a",
        colorStops: "Puntos de Color",
        randomize: "Aleatorio Total",
        addStop: "Agregar Punto",
        configuration: "ConfiguraciÃ³n",
        stepsPrecision: "Pasos / PrecisiÃ³n",
        vividMode: "Modo VÃ­vido (LAB)",
        vividDescription: "InterpolaciÃ³n perceptualmente uniforme que evita 'zonas grises muertas' en degradados.",
        gallery: "GalerÃ­a",
        analyze: "Analizar",
        saveGradient: "Guardar Degradado",
        downloadExport: "Descargar / Exportar",
        copyCSS: "ğŸ“‹ Copiar CSS",
        copyTailwind: "ğŸ’¨ Copiar Tailwind",
        downloadCSS: "ğŸ“„ Descargar .CSS",
        downloadPNG: "ğŸ–¼ï¸ Descargar .PNG",
        gradientSpectrum: "Espectro de Degradado",
        spectrumHint: "Pasar para identificar, clic para copiar",
        gradientGallery: "GalerÃ­a de Degradados",
        colorAnalysis: "AnÃ¡lisis de Color",
        clickToCopy: "CLIC PARA COPIAR",
        clickToCopyTitle: "Clic para copiar",
        randomCount: "Aleatorio (2-5)",
        twoColors: "2 Colores",
        threeColors: "3 Colores",
        fourColors: "4 Colores",
        fiveColors: "5 Colores",
        basePosition: "PosiciÃ³n del Color Base",
        atStart: "Al Inicio",
        atEnd: "Al Final",
        inMiddle: "En Medio",
        randomPosition: "Aleatorio",
        builtinGradients: "Degradados Incorporados",
        mySavedGradients: "Mis Degradados Guardados",
        clearAll: "Limpiar Todo"
      },
      de: {
        appTitle: "Lumina Studio",
        smartGenerator: "Harmonie-Generator",
        baseColor: "Grundfarbe",
        harmonyMode: "Farbanzahl",
        generatePalette: "Neue Harmonie Generieren",
        colorStops: "Farbstopps",
        randomize: "Alles ZufÃ¤llig",
        addStop: "Stopp HinzufÃ¼gen",
        configuration: "Konfiguration",
        stepsPrecision: "Schritte / PrÃ¤zision",
        vividMode: "Lebhafter Modus (LAB)",
        vividDescription: "WahrnehmungsgleichmÃ¤ÃŸige Interpolation, die 'graue tote Zonen' in VerlÃ¤ufen verhindert.",
        gallery: "Galerie",
        analyze: "Analysieren",
        saveGradient: "Verlauf Speichern",
        downloadExport: "Herunterladen / Exportieren",
        copyCSS: "ğŸ“‹ CSS Kopieren",
        copyTailwind: "ğŸ’¨ Tailwind Kopieren",
        downloadCSS: "ğŸ“„ .CSS Herunterladen",
        downloadPNG: "ğŸ–¼ï¸ .PNG Herunterladen",
        gradientSpectrum: "Verlaufsspektrum",
        spectrumHint: "DarÃ¼berfahren zum Identifizieren, Klicken zum Kopieren",
        gradientGallery: "Verlaufsgalerie",
        colorAnalysis: "Farbanalyse",
        clickToCopy: "KLICKEN ZUM KOPIEREN",
        clickToCopyTitle: "Klicken zum Kopieren",
        randomCount: "ZufÃ¤llig (2-5)",
        twoColors: "2 Farben",
        threeColors: "3 Farben",
        fourColors: "4 Farben",
        fiveColors: "5 Farben",
        basePosition: "Grundfarbenposition",
        atStart: "Am Anfang",
        atEnd: "Am Ende",
        inMiddle: "In der Mitte",
        randomPosition: "ZufÃ¤llig",
        builtinGradients: "Eingebaute VerlÃ¤ufe",
        mySavedGradients: "Meine Gespeicherten VerlÃ¤ufe",
        clearAll: "Alle LÃ¶schen"
      },
      zh: {
        appTitle: "Lumina Studio",
        smartGenerator: "å’Œè°ç”Ÿæˆå™¨",
        baseColor: "åŸºç¡€é¢œè‰²",
        harmonyMode: "é¢œè‰²æ•°é‡",
        generatePalette: "ç”Ÿæˆæ–°å’Œè°",
        colorStops: "é¢œè‰²åœæ­¢ç‚¹",
        randomize: "å…¨éƒ¨éšæœº",
        addStop: "æ·»åŠ åœæ­¢ç‚¹",
        configuration: "é…ç½®",
        stepsPrecision: "æ­¥æ•° / ç²¾åº¦",
        vividMode: "é²œè‰³æ¨¡å¼ (LAB)",
        vividDescription: "æ„ŸçŸ¥å‡åŒ€æ’å€¼ï¼Œé˜²æ­¢æ¸å˜ä¸­å‡ºç°'ç°è‰²æ­»åŒº'ã€‚",
        gallery: "ç”»å»Š",
        analyze: "åˆ†æ",
        saveGradient: "ä¿å­˜æ¸å˜",
        downloadExport: "ä¸‹è½½ / å¯¼å‡º",
        copyCSS: "ğŸ“‹ å¤åˆ¶ CSS",
        copyTailwind: "ğŸ’¨ å¤åˆ¶ Tailwind",
        downloadCSS: "ğŸ“„ ä¸‹è½½ .CSS",
        downloadPNG: "ğŸ–¼ï¸ ä¸‹è½½ .PNG",
        gradientSpectrum: "æ¸å˜å…‰è°±",
        spectrumHint: "æ‚¬åœä»¥è¯†åˆ«ï¼Œç‚¹å‡»ä»¥å¤åˆ¶",
        gradientGallery: "æ¸å˜ç”»å»Š",
        colorAnalysis: "é¢œè‰²åˆ†æ",
        clickToCopy: "ç‚¹å‡»å¤åˆ¶",
        clickToCopyTitle: "ç‚¹å‡»å¤åˆ¶",
        randomCount: "éšæœº (2-5)",
        twoColors: "2 é¢œè‰²",
        threeColors: "3 é¢œè‰²",
        fourColors: "4 é¢œè‰²",
        fiveColors: "5 é¢œè‰²",
        basePosition: "åŸºç¡€é¢œè‰²ä½ç½®",
        atStart: "åœ¨å¼€å§‹",
        atEnd: "åœ¨ç»“æŸ",
        inMiddle: "åœ¨ä¸­é—´",
        randomPosition: "éšæœº",
        builtinGradients: "å†…ç½®æ¸å˜",
        mySavedGradients: "æˆ‘çš„å·²ä¿å­˜æ¸å˜",
        clearAll: "æ¸…é™¤å…¨éƒ¨"
      },
      ja: {
        appTitle: "Lumina Studio",
        smartGenerator: "èª¿å’Œã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼",
        baseColor: "ãƒ™ãƒ¼ã‚¹ã‚«ãƒ©ãƒ¼",
        harmonyMode: "è‰²æ•°",
        generatePalette: "æ–°èª¿å’Œã‚’ç”Ÿæˆ",
        colorStops: "ã‚«ãƒ©ãƒ¼ã‚¹ãƒˆãƒƒãƒ—",
        randomize: "å…¨ã¦ãƒ©ãƒ³ãƒ€ãƒ ",
        addStop: "ã‚¹ãƒˆãƒƒãƒ—è¿½åŠ ",
        configuration: "è¨­å®š",
        stepsPrecision: "ã‚¹ãƒ†ãƒƒãƒ—æ•° / ç²¾åº¦",
        vividMode: "ãƒ“ãƒ“ãƒƒãƒ‰ãƒ¢ãƒ¼ãƒ‰ (LAB)",
        vividDescription: "ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã®'ç°è‰²ãƒ‡ãƒƒãƒ‰ã‚¾ãƒ¼ãƒ³'ã‚’é˜²ãçŸ¥è¦šå‡ä¸€è£œé–“ã€‚",
        gallery: "ã‚®ãƒ£ãƒ©ãƒªãƒ¼",
        analyze: "åˆ†æ",
        saveGradient: "ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ä¿å­˜",
        downloadExport: "ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ / ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ",
        copyCSS: "ğŸ“‹ CSSã‚³ãƒ”ãƒ¼",
        copyTailwind: "ğŸ’¨ Tailwindã‚³ãƒ”ãƒ¼",
        downloadCSS: "ğŸ“„ .CSSãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰",
        downloadPNG: "ğŸ–¼ï¸ .PNGãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰",
        gradientSpectrum: "ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¹ãƒšã‚¯ãƒˆãƒ«",
        spectrumHint: "è­˜åˆ¥ã™ã‚‹ã«ã¯ãƒ›ãƒãƒ¼ã€ã‚³ãƒ”ãƒ¼ã™ã‚‹ã«ã¯ã‚¯ãƒªãƒƒã‚¯",
        gradientGallery: "ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚®ãƒ£ãƒ©ãƒªãƒ¼",
        colorAnalysis: "ã‚«ãƒ©ãƒ¼åˆ†æ",
        clickToCopy: "ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã‚³ãƒ”ãƒ¼",
        clickToCopyTitle: "ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã‚³ãƒ”ãƒ¼",
        randomCount: "ãƒ©ãƒ³ãƒ€ãƒ  (2-5)",
        twoColors: "2è‰²",
        threeColors: "3è‰²",
        fourColors: "4è‰²",
        fiveColors: "5è‰²",
        basePosition: "ãƒ™ãƒ¼ã‚¹ã‚«ãƒ©ãƒ¼ä½ç½®",
        atStart: "é–‹å§‹æ™‚",
        atEnd: "çµ‚äº†æ™‚",
        inMiddle: "ä¸­é–“",
        randomPosition: "ãƒ©ãƒ³ãƒ€ãƒ ",
        builtinGradients: "çµ„ã¿è¾¼ã¿ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³",
        mySavedGradients: "ä¿å­˜æ¸ˆã¿ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³",
        clearAll: "å…¨ã¦ã‚¯ãƒªã‚¢"
      },
      ru: {
        appTitle: "Lumina Studio",
        smartGenerator: "Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ‚Ğ¾Ñ€ Ğ“Ğ°Ñ€Ğ¼Ğ¾Ğ½Ğ¸Ğ¸",
        baseColor: "Ğ‘Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğ¹ Ğ¦Ğ²ĞµÑ‚",
        harmonyMode: "ĞšĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ Ğ¦Ğ²ĞµÑ‚Ğ¾Ğ²",
        generatePalette: "Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ ĞĞ¾Ğ²ÑƒÑ Ğ“Ğ°Ñ€Ğ¼Ğ¾Ğ½Ğ¸Ñ",
        colorStops: "Ğ¦Ğ²ĞµÑ‚Ğ¾Ğ²Ñ‹Ğµ ĞÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ¸",
        randomize: "Ğ’ÑĞµ Ğ¡Ğ»ÑƒÑ‡Ğ°Ğ¹Ğ½Ğ¾",
        addStop: "Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ ĞÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºÑƒ",
        configuration: "ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ",
        stepsPrecision: "Ğ¨Ğ°Ğ³Ğ¸ / Ğ¢Ğ¾Ñ‡Ğ½Ğ¾ÑÑ‚ÑŒ",
        vividMode: "Ğ¯Ñ€ĞºĞ¸Ğ¹ Ğ ĞµĞ¶Ğ¸Ğ¼ (LAB)",
        vividDescription: "Ğ’Ğ¾ÑĞ¿Ñ€Ğ¸Ğ½Ğ¸Ğ¼Ğ°ĞµĞ¼Ğ¾ Ñ€Ğ°Ğ²Ğ½Ğ¾Ğ¼ĞµÑ€Ğ½Ğ°Ñ Ğ¸Ğ½Ñ‚ĞµÑ€Ğ¿Ğ¾Ğ»ÑÑ†Ğ¸Ñ, Ğ¿Ñ€ĞµĞ´Ğ¾Ñ‚Ğ²Ñ€Ğ°Ñ‰Ğ°ÑÑ‰Ğ°Ñ 'ÑĞµÑ€Ñ‹Ğµ Ğ¼ĞµÑ€Ñ‚Ğ²Ñ‹Ğµ Ğ·Ğ¾Ğ½Ñ‹' Ğ² Ğ³Ñ€Ğ°Ğ´Ğ¸ĞµĞ½Ñ‚Ğ°Ñ….",
        gallery: "Ğ“Ğ°Ğ»ĞµÑ€ĞµÑ",
        analyze: "ĞĞ½Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ",
        saveGradient: "Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑŒ Ğ“Ñ€Ğ°Ğ´Ğ¸ĞµĞ½Ñ‚",
        downloadExport: "Ğ¡ĞºĞ°Ñ‡Ğ°Ñ‚ÑŒ / Ğ­ĞºÑĞ¿Ğ¾Ñ€Ñ‚",
        copyCSS: "ğŸ“‹ ĞšĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ CSS",
        copyTailwind: "ğŸ’¨ ĞšĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Tailwind",
        downloadCSS: "ğŸ“„ Ğ¡ĞºĞ°Ñ‡Ğ°Ñ‚ÑŒ .CSS",
        downloadPNG: "ğŸ–¼ï¸ Ğ¡ĞºĞ°Ñ‡Ğ°Ñ‚ÑŒ .PNG",
        gradientSpectrum: "Ğ¡Ğ¿ĞµĞºÑ‚Ñ€ Ğ“Ñ€Ğ°Ğ´Ğ¸ĞµĞ½Ñ‚Ğ°",
        spectrumHint: "ĞĞ°Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ğ´Ğ»Ñ Ğ¸Ğ´ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ğ¸, Ğ½Ğ°Ğ¶Ğ¼Ğ¸Ñ‚Ğµ Ğ´Ğ»Ñ ĞºĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ",
        gradientGallery: "Ğ“Ğ°Ğ»ĞµÑ€ĞµÑ Ğ“Ñ€Ğ°Ğ´Ğ¸ĞµĞ½Ñ‚Ğ¾Ğ²",
        colorAnalysis: "ĞĞ½Ğ°Ğ»Ğ¸Ğ· Ğ¦Ğ²ĞµÑ‚Ğ°",
        clickToCopy: "ĞĞĞ–ĞœĞ˜Ğ¢Ğ• Ğ”Ğ›Ğ¯ ĞšĞĞŸĞ˜Ğ ĞĞ’ĞĞĞ˜Ğ¯",
        clickToCopyTitle: "ĞĞ°Ğ¶Ğ¼Ğ¸Ñ‚Ğµ Ğ´Ğ»Ñ ĞºĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ",
        randomCount: "Ğ¡Ğ»ÑƒÑ‡Ğ°Ğ¹Ğ½Ğ¾ (2-5)",
        twoColors: "2 Ğ¦Ğ²ĞµÑ‚Ğ°",
        threeColors: "3 Ğ¦Ğ²ĞµÑ‚Ğ°",
        fourColors: "4 Ğ¦Ğ²ĞµÑ‚Ğ°",
        fiveColors: "5 Ğ¦Ğ²ĞµÑ‚Ğ¾Ğ²",
        basePosition: "ĞŸĞ¾Ğ·Ğ¸Ñ†Ğ¸Ñ Ğ‘Ğ°Ğ·Ğ¾Ğ²Ğ¾Ğ³Ğ¾ Ğ¦Ğ²ĞµÑ‚Ğ°",
        atStart: "Ğ’ ĞĞ°Ñ‡Ğ°Ğ»Ğµ",
        atEnd: "Ğ’ ĞšĞ¾Ğ½Ñ†Ğµ",
        inMiddle: "Ğ’ Ğ¡ĞµÑ€ĞµĞ´Ğ¸Ğ½Ğµ",
        randomPosition: "Ğ¡Ğ»ÑƒÑ‡Ğ°Ğ¹Ğ½Ğ¾",
        builtinGradients: "Ğ’ÑÑ‚Ñ€Ğ¾ĞµĞ½Ğ½Ñ‹Ğµ Ğ“Ñ€Ğ°Ğ´Ğ¸ĞµĞ½Ñ‚Ñ‹",
        mySavedGradients: "ĞœĞ¾Ğ¸ Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ½Ñ‹Ğµ Ğ“Ñ€Ğ°Ğ´Ğ¸ĞµĞ½Ñ‚Ñ‹",
        clearAll: "ĞÑ‡Ğ¸ÑÑ‚Ğ¸Ñ‚ÑŒ Ğ’ÑĞµ"
      },
      tr: {
        appTitle: "Lumina Studio",
        smartGenerator: "Uyum Ãœreteci",
        baseColor: "Temel Renk",
        harmonyMode: "Renk SayÄ±sÄ±",
        generatePalette: "Yeni Uyum OluÅŸtur",
        colorStops: "Renk DuraklarÄ±",
        randomize: "Hepsini Rastgele",
        addStop: "Durak Ekle",
        configuration: "YapÄ±landÄ±rma",
        stepsPrecision: "AdÄ±mlar / Hassasiyet",
        vividMode: "CanlÄ± Mod (LAB)",
        vividDescription: "Gradyanlarda 'gri Ã¶lÃ¼ bÃ¶lgeleri' Ã¶nleyen algÄ±sal dÃ¼zgÃ¼n enterpolasyon.",
        gallery: "Galeri",
        analyze: "Analiz Et",
        saveGradient: "Gradyan Kaydet",
        downloadExport: "Ä°ndir / DÄ±ÅŸa Aktar",
        copyCSS: "ğŸ“‹ CSS Kopyala",
        copyTailwind: "ğŸ’¨ Tailwind Kopyala",
        downloadCSS: "ğŸ“„ .CSS Ä°ndir",
        downloadPNG: "ğŸ–¼ï¸ .PNG Ä°ndir",
        gradientSpectrum: "Gradyan Spektrumu",
        spectrumHint: "TanÄ±mlamak iÃ§in Ã¼zerine gel, kopyalamak iÃ§in tÄ±kla",
        gradientGallery: "Gradyan Galerisi",
        colorAnalysis: "Renk Analizi",
        clickToCopy: "KOPYALAMAK Ä°Ã‡Ä°N TIKLA",
        clickToCopyTitle: "Kopyalamak iÃ§in tÄ±kla",
        randomCount: "Rastgele (2-5)",
        twoColors: "2 Renk",
        threeColors: "3 Renk",
        fourColors: "4 Renk",
        fiveColors: "5 Renk",
        basePosition: "Temel Renk Konumu",
        atStart: "BaÅŸlangÄ±Ã§ta",
        atEnd: "Sonda",
        inMiddle: "Ortada",
        randomPosition: "Rastgele",
        builtinGradients: "YerleÅŸik Gradyanlar",
        mySavedGradients: "KaydedilmiÅŸ GradyanlarÄ±m",
        clearAll: "Hepsini Temizle"
      },
      pt: {
        appTitle: "Lumina Studio",
        smartGenerator: "Gerador de Harmonia",
        baseColor: "Cor Base",
        harmonyMode: "Contagem de Cores",
        generatePalette: "Gerar Nova Harmonia",
        colorStops: "Paradas de Cor",
        randomize: "Aleatorizar Tudo",
        addStop: "Adicionar Parada",
        configuration: "ConfiguraÃ§Ã£o",
        stepsPrecision: "Passos / PrecisÃ£o",
        vividMode: "Modo VÃ­vido (LAB)",
        vividDescription: "InterpolaÃ§Ã£o perceptual uniforme prevenindo 'zonas cinzentas mortas' em gradientes.",
        gallery: "Galeria",
        analyze: "Analisar",
        saveGradient: "Salvar Gradiente",
        downloadExport: "Descarregar / Exportar",
        copyCSS: "ğŸ“‹ Copiar CSS",
        copyTailwind: "ğŸ’¨ Copiar Tailwind",
        downloadCSS: "ğŸ“„ Descarregar .CSS",
        downloadPNG: "ğŸ–¼ï¸ Descarregar .PNG",
        gradientSpectrum: "Espectro de Gradiente",
        spectrumHint: "Passar por cima para identificar, clicar para copiar",
        gradientGallery: "Galeria de Gradientes",
        colorAnalysis: "AnÃ¡lise de Cor",
        clickToCopy: "CLICAR PARA COPIAR",
        clickToCopyTitle: "Clicar para copiar",
        randomCount: "AleatÃ³rio (2-5)",
        twoColors: "2 Cores",
        threeColors: "3 Cores",
        fourColors: "4 Cores",
        fiveColors: "5 Cores",
        basePosition: "PosiÃ§Ã£o da Cor Base",
        atStart: "No InÃ­cio",
        atEnd: "No Fim",
        inMiddle: "No Meio",
        randomPosition: "AleatÃ³rio",
        builtinGradients: "Gradientes Incorporados",
        mySavedGradients: "Meus Gradientes Guardados",
        clearAll: "Limpar Tudo"
      },
      hi: {
        appTitle: "Lumina Studio",
        smartGenerator: "à¤¸à¤¾à¤®à¤‚à¤œà¤¸à¥à¤¯ à¤œà¤¨à¤°à¥‡à¤Ÿà¤°",
        baseColor: "à¤†à¤§à¤¾à¤° à¤°à¤‚à¤—",
        harmonyMode: "à¤°à¤‚à¤— à¤¸à¤‚à¤–à¥à¤¯à¤¾",
        generatePalette: "à¤¨à¤¯à¤¾ à¤¸à¤¾à¤®à¤‚à¤œà¤¸à¥à¤¯ à¤‰à¤¤à¥à¤ªà¤¨à¥à¤¨ à¤•à¤°à¥‡à¤‚",
        colorStops: "à¤°à¤‚à¤— à¤¸à¥à¤Ÿà¥‰à¤ª",
        randomize: "à¤¸à¤­à¥€ à¤¯à¤¾à¤¦à¥ƒà¤šà¥à¤›à¤¿à¤•",
        addStop: "à¤¸à¥à¤Ÿà¥‰à¤ª à¤œà¥‹à¤¡à¤¼à¥‡à¤‚",
        configuration: "à¤•à¥‰à¤¨à¥à¤«à¤¼à¤¿à¤—à¤°à¥‡à¤¶à¤¨",
        stepsPrecision: "à¤šà¤°à¤£ / à¤¸à¤Ÿà¥€à¤•à¤¤à¤¾",
        vividMode: "à¤µà¤¿à¤µà¤¿à¤¡ à¤®à¥‹à¤¡ (LAB)",
        vividDescription: "à¤—à¥à¤°à¥‡à¤¡à¤¿à¤à¤‚à¤Ÿà¥à¤¸ à¤®à¥‡à¤‚ 'à¤—à¥à¤°à¥‡ à¤¡à¥‡à¤¡ à¤œà¤¼à¥‹à¤¨' à¤°à¥‹à¤•à¤¨à¥‡ à¤µà¤¾à¤²à¤¾ à¤¸à¤‚à¤µà¥‡à¤¦à¥€ à¤¸à¤®à¤¾à¤¨ à¤ªà¥à¤°à¤•à¥à¤·à¥‡à¤ªà¥¤",
        gallery: "à¤—à¥ˆà¤²à¤°à¥€",
        analyze: "à¤µà¤¿à¤¶à¥à¤²à¥‡à¤·à¤£ à¤•à¤°à¥‡à¤‚",
        saveGradient: "à¤—à¥à¤°à¥‡à¤¡à¤¿à¤à¤‚à¤Ÿ à¤¸à¤¹à¥‡à¤œà¥‡à¤‚",
        downloadExport: "à¤¡à¤¾à¤‰à¤¨à¤²à¥‹à¤¡ / à¤¨à¤¿à¤°à¥à¤¯à¤¾à¤¤",
        copyCSS: "ğŸ“‹ CSS à¤•à¥‰à¤ªà¥€ à¤•à¤°à¥‡à¤‚",
        copyTailwind: "ğŸ’¨ Tailwind à¤•à¥‰à¤ªà¥€ à¤•à¤°à¥‡à¤‚",
        downloadCSS: "ğŸ“„ .CSS à¤¡à¤¾à¤‰à¤¨à¤²à¥‹à¤¡ à¤•à¤°à¥‡à¤‚",
        downloadPNG: "ğŸ–¼ï¸ .PNG à¤¡à¤¾à¤‰à¤¨à¤²à¥‹à¤¡ à¤•à¤°à¥‡à¤‚",
        gradientSpectrum: "à¤—à¥à¤°à¥‡à¤¡à¤¿à¤à¤‚à¤Ÿ à¤¸à¥à¤ªà¥‡à¤•à¥à¤Ÿà¥à¤°à¤®",
        spectrumHint: "à¤ªà¤¹à¤šà¤¾à¤¨à¤¨à¥‡ à¤•à¥‡ à¤²à¤¿à¤ à¤¹à¥‹à¤µà¤° à¤•à¤°à¥‡à¤‚, à¤•à¥‰à¤ªà¥€ à¤•à¤°à¤¨à¥‡ à¤•à¥‡ à¤²à¤¿à¤ à¤•à¥à¤²à¤¿à¤• à¤•à¤°à¥‡à¤‚",
        gradientGallery: "à¤—à¥à¤°à¥‡à¤¡à¤¿à¤à¤‚à¤Ÿ à¤—à¥ˆà¤²à¤°à¥€",
        colorAnalysis: "à¤°à¤‚à¤— à¤µà¤¿à¤¶à¥à¤²à¥‡à¤·à¤£",
        clickToCopy: "à¤•à¥‰à¤ªà¥€ à¤•à¤°à¤¨à¥‡ à¤•à¥‡ à¤²à¤¿à¤ à¤•à¥à¤²à¤¿à¤• à¤•à¤°à¥‡à¤‚",
        clickToCopyTitle: "à¤•à¥‰à¤ªà¥€ à¤•à¤°à¤¨à¥‡ à¤•à¥‡ à¤²à¤¿à¤ à¤•à¥à¤²à¤¿à¤• à¤•à¤°à¥‡à¤‚",
        randomCount: "à¤¯à¤¾à¤¦à¥ƒà¤šà¥à¤›à¤¿à¤• (2-5)",
        twoColors: "2 à¤°à¤‚à¤—",
        threeColors: "3 à¤°à¤‚à¤—",
        fourColors: "4 à¤°à¤‚à¤—",
        fiveColors: "5 à¤°à¤‚à¤—",
        basePosition: "à¤†à¤§à¤¾à¤° à¤°à¤‚à¤— à¤¸à¥à¤¥à¤¿à¤¤à¤¿",
        atStart: "à¤¶à¥à¤°à¥à¤†à¤¤ à¤®à¥‡à¤‚",
        atEnd: "à¤…à¤‚à¤¤ à¤®à¥‡à¤‚",
        inMiddle: "à¤¬à¥€à¤š à¤®à¥‡à¤‚",
        randomPosition: "à¤¯à¤¾à¤¦à¥ƒà¤šà¥à¤›à¤¿à¤•",
        builtinGradients: "à¤…à¤‚à¤¤à¤°à¥à¤¨à¤¿à¤¹à¤¿à¤¤ à¤—à¥à¤°à¥‡à¤¡à¤¿à¤à¤‚à¤Ÿà¥à¤¸",
        mySavedGradients: "à¤®à¥‡à¤°à¥‡ à¤¸à¤¹à¥‡à¤œà¥‡ à¤—à¤ à¤—à¥à¤°à¥‡à¤¡à¤¿à¤à¤‚à¤Ÿà¥à¤¸",
        clearAll: "à¤¸à¤¬ à¤¸à¤¾à¤« à¤•à¤°à¥‡à¤‚"
      },
      ko: {
        appTitle: "Lumina Studio",
        smartGenerator: "ì¡°í™” ìƒì„±ê¸°",
        baseColor: "ê¸°ë³¸ ìƒ‰ìƒ",
        harmonyMode: "ìƒ‰ìƒ ìˆ˜",
        generatePalette: "ìƒˆë¡œìš´ ì¡°í™” ìƒì„±",
        colorStops: "ìƒ‰ìƒ ì •ì§€ì ",
        randomize: "ì „ì²´ ë¬´ì‘ìœ„",
        addStop: "ì •ì§€ì  ì¶”ê°€",
        configuration: "êµ¬ì„±",
        stepsPrecision: "ë‹¨ê³„ / ì •ë°€ë„",
        vividMode: "ìƒìƒ ëª¨ë“œ (LAB)",
        vividDescription: "ê·¸ë¼ë°ì´ì…˜ì˜ 'íšŒìƒ‰ ì£½ì€ ì§€ëŒ€'ë¥¼ ë°©ì§€í•˜ëŠ” ì¸ì§€ ê· ì¼ ë³´ê°„.",
        gallery: "ê°¤ëŸ¬ë¦¬",
        analyze: "ë¶„ì„",
        saveGradient: "ê·¸ë¼ë°ì´ì…˜ ì €ì¥",
        downloadExport: "ë‹¤ìš´ë¡œë“œ / ë‚´ë³´ë‚´ê¸°",
        copyCSS: "ğŸ“‹ CSS ë³µì‚¬",
        copyTailwind: "ğŸ’¨ Tailwind ë³µì‚¬",
        downloadCSS: "ğŸ“„ .CSS ë‹¤ìš´ë¡œë“œ",
        downloadPNG: "ğŸ–¼ï¸ .PNG ë‹¤ìš´ë¡œë“œ",
        gradientSpectrum: "ê·¸ë¼ë°ì´ì…˜ ìŠ¤í™íŠ¸ëŸ¼",
        spectrumHint: "ì‹ë³„í•˜ë ¤ë©´ ë§ˆìš°ìŠ¤ë¥¼ ì˜¬ë¦¬ê³ , ë³µì‚¬í•˜ë ¤ë©´ í´ë¦­",
        gradientGallery: "ê·¸ë¼ë°ì´ì…˜ ê°¤ëŸ¬ë¦¬",
        colorAnalysis: "ìƒ‰ìƒ ë¶„ì„",
        clickToCopy: "ë³µì‚¬í•˜ë ¤ë©´ í´ë¦­",
        clickToCopyTitle: "ë³µì‚¬í•˜ë ¤ë©´ í´ë¦­",
        randomCount: "ë¬´ì‘ìœ„ (2-5)",
        twoColors: "2ìƒ‰",
        threeColors: "3ìƒ‰",
        fourColors: "4ìƒ‰",
        fiveColors: "5ìƒ‰",
        basePosition: "ê¸°ë³¸ ìƒ‰ìƒ ìœ„ì¹˜",
        atStart: "ì‹œì‘ ë¶€ë¶„",
        atEnd: "ë ë¶€ë¶„",
        inMiddle: "ì¤‘ê°„",
        randomPosition: "ë¬´ì‘ìœ„",
        builtinGradients: "ë‚´ì¥ ê·¸ë¼ë°ì´ì…˜",
        mySavedGradients: "ë‚´ê°€ ì €ì¥í•œ ê·¸ë¼ë°ì´ì…˜",
        clearAll: "ëª¨ë‘ ì§€ìš°ê¸°"
      },
      it: {
        appTitle: "Lumina Studio",
        smartGenerator: "Generatore di Armonia",
        baseColor: "Colore Base",
        harmonyMode: "Numero di Colori",
        generatePalette: "Genera Nuova Armonia",
        colorStops: "Fermate Colore",
        randomize: "Tutto Casuale",
        addStop: "Aggiungi Fermata",
        configuration: "Configurazione",
        stepsPrecision: "Passi / Precisione",
        vividMode: "ModalitÃ  Vivida (LAB)",
        vividDescription: "Interpolazione percettualmente uniforme che previene 'zone grigie morte' in gradienti.",
        gallery: "Galleria",
        analyze: "Analizza",
        saveGradient: "Salva Gradiente",
        downloadExport: "Scarica / Esporta",
        copyCSS: "ğŸ“‹ Copia CSS",
        copyTailwind: "ğŸ’¨ Copia Tailwind",
        downloadCSS: "ğŸ“„ Scarica .CSS",
        downloadPNG: "ğŸ–¼ï¸ Scarica .PNG",
        gradientSpectrum: "Spettro Gradiente",
        spectrumHint: "Passa sopra per identificare, clicca per copiare",
        gradientGallery: "Galleria Gradienti",
        colorAnalysis: "Analisi Colore",
        clickToCopy: "CLICCA PER COPIARE",
        clickToCopyTitle: "Clicca per copiare",
        randomCount: "Casuale (2-5)",
        twoColors: "2 Colori",
        threeColors: "3 Colori",
        fourColors: "4 Colori",
        fiveColors: "5 Colori",
        basePosition: "Posizione Colore Base",
        atStart: "All'Inizio",
        atEnd: "Alla Fine",
        inMiddle: "In Mezzo",
        randomPosition: "Casuale",
        builtinGradients: "Gradienti Incorporati",
        mySavedGradients: "Miei Gradienti Salvati",
        clearAll: "Cancella Tutto"
      }
    };

    function setLanguage(lang) {
      state.language = lang;
      DOM.body.setAttribute('dir', lang === 'ar' ? 'rtl' : 'ltr');
      
      const langNames = {
        en: "EN", ar: "AR", fr: "FR", es: "ES", 
        de: "DE", zh: "ZH", ja: "JA", ru: "RU",
        tr: "TR", pt: "PT", hi: "HI", ko: "KO", it: "IT"
      };
      DOM.langToggle.textContent = `ğŸŒ ${langNames[lang]}`;
      
      DOM.langOptions.forEach(option => {
        if (option.dataset.lang === lang) {
          option.classList.add('active');
        } else {
          option.classList.remove('active');
        }
      });
      
      document.querySelectorAll('[data-i18n]').forEach(el => {
        const key = el.getAttribute('data-i18n');
        if (translations[lang] && translations[lang][key]) {
          el.textContent = translations[lang][key];
        } else if (translations['en'][key]) {
          el.textContent = translations['en'][key];
        }
      });
      
      document.querySelectorAll('[data-i18n-title]').forEach(el => {
        const key = el.getAttribute('data-i18n-title');
        if (translations[lang] && translations[lang][key]) {
          el.title = translations[lang][key];
        } else if (translations['en'][key]) {
          el.title = translations['en'][key];
        }
      });
      
      document.querySelectorAll('select option').forEach(option => {
        const key = option.getAttribute('data-i18n');
        if (key && translations[lang] && translations[lang][key]) {
          option.textContent = translations[lang][key];
        } else if (key && translations['en'][key]) {
          option.textContent = translations['en'][key];
        }
      });
      
      showToast(getMessage('languageChanged'));
    }

    // Helper function to get localized messages
    function getMessage(key) {
      const messages = {
        languageChanged: {
          en: 'Language changed to English',
          ar: 'ØªÙ… ØªØºÙŠÙŠØ± Ø§Ù„Ù„ØºØ© Ø¥Ù„Ù‰ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©',
          fr: 'Langue changÃ©e en franÃ§ais',
          es: 'Idioma cambiado a espaÃ±ol',
          de: 'Sprache zu Deutsch geÃ¤ndert',
          zh: 'è¯­è¨€å·²æ›´æ”¹ä¸ºä¸­æ–‡',
          ja: 'è¨€èªãŒæ—¥æœ¬èªã«å¤‰æ›´ã•ã‚Œã¾ã—ãŸ',
          ru: 'Ğ¯Ğ·Ñ‹Ğº Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½ Ğ½Ğ° Ñ€ÑƒÑÑĞºĞ¸Ğ¹',
          tr: 'Dil TÃ¼rkÃ§e olarak deÄŸiÅŸtirildi',
          pt: 'Idioma alterado para portuguÃªs',
          hi: 'à¤­à¤¾à¤·à¤¾ à¤¹à¤¿à¤‚à¤¦à¥€ à¤®à¥‡à¤‚ à¤¬à¤¦à¤²à¥€ à¤—à¤ˆ',
          ko: 'ì–¸ì–´ê°€ í•œêµ­ì–´ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤',
          it: 'Lingua cambiata in italiano'
        },
        paletteGenerated: {
          en: 'New harmonious palette generated',
          ar: 'ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù„ÙˆØ­Ø© Ø£Ù„ÙˆØ§Ù† Ù…ØªÙ†Ø§Ø³Ù‚Ø© Ø¬Ø¯ÙŠØ¯Ø©',
          fr: 'Nouvelle palette harmonieuse gÃ©nÃ©rÃ©e',
          es: 'Nueva paleta armÃ³nica generada',
          de: 'Neue harmonische Palette erstellt',
          zh: 'æ–°çš„å’Œè°è°ƒè‰²æ¿å·²ç”Ÿæˆ',
          ja: 'æ–°ã—ã„èª¿å’Œãƒ‘ãƒ¬ãƒƒãƒˆãŒç”Ÿæˆã•ã‚Œã¾ã—ãŸ',
          ru: 'ĞĞ¾Ğ²Ğ°Ñ Ğ³Ğ°Ñ€Ğ¼Ğ¾Ğ½Ğ¸Ñ‡Ğ½Ğ°Ñ Ğ¿Ğ°Ğ»Ğ¸Ñ‚Ñ€Ğ° ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ°',
          tr: 'Yeni uyumlu palet oluÅŸturuldu',
          pt: 'Nova paleta harmoniosa gerada',
          hi: 'à¤¨à¤¯à¤¾ à¤¸à¤¾à¤®à¤‚à¤œà¤¸à¥à¤¯à¤ªà¥‚à¤°à¥à¤£ à¤ªà¥ˆà¤²à¥‡à¤Ÿ à¤‰à¤¤à¥à¤ªà¤¨à¥à¤¨ à¤¹à¥à¤†',
          ko: 'ìƒˆë¡œìš´ ì¡°í™”ë¡œìš´ íŒ”ë ˆíŠ¸ ìƒì„±ë¨',
          it: 'Nuova palette armoniosa generata'
        },
        gradientSaved: {
          en: 'Gradient saved to your gallery',
          ar: 'ØªÙ… Ø­ÙØ¸ Ø§Ù„ØªØ¯Ø±Ø¬ ÙÙŠ Ù…Ø¹Ø±Ø¶Ùƒ',
          fr: 'DÃ©gradÃ© enregistrÃ© dans votre galerie',
          es: 'Degradado guardado en tu galerÃ­a',
          de: 'Verlauf in deiner Galerie gespeichert',
          zh: 'æ¸å˜å·²ä¿å­˜åˆ°æ‚¨çš„ç”»å»Š',
          ja: 'ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãŒã‚®ãƒ£ãƒ©ãƒªãƒ¼ã«ä¿å­˜ã•ã‚Œã¾ã—ãŸ',
          ru: 'Ğ“Ñ€Ğ°Ğ´Ğ¸ĞµĞ½Ñ‚ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½ Ğ² Ğ²Ğ°ÑˆÑƒ Ğ³Ğ°Ğ»ĞµÑ€ĞµÑ',
          tr: 'Gradyan galerinize kaydedildi',
          pt: 'Gradiente guardado na sua galeria',
          hi: 'à¤—à¥à¤°à¥‡à¤¡à¤¿à¤à¤‚à¤Ÿ à¤†à¤ªà¤•à¥€ à¤—à¥ˆà¤²à¤°à¥€ à¤®à¥‡à¤‚ à¤¸à¤¹à¥‡à¤œà¤¾ à¤—à¤¯à¤¾',
          ko: 'ê·¸ë¼ë°ì´ì…˜ì´ ê°¤ëŸ¬ë¦¬ì— ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤',
          it: 'Gradiente salvato nella tua galleria'
        }
      };
      return messages[key] && messages[key][state.language] ? messages[key][state.language] : messages[key].en;
    }

    /* ---------- Color Utilities ---------- */
    const clamp = (v,a,b) => Math.max(a,Math.min(b,v));
    const normHex = (h) => {
      if(!h) return '#000000';
      h = String(h).trim().toUpperCase();
      if(!h.startsWith('#')) h = '#'+h;
      if(/^#[0-9A-F]{3}$/i.test(h)) h = '#'+h.slice(1).split('').map(x=>x+x).join('');
      return /^#[0-9A-F]{6}$/i.test(h) ? h : '#000000';
    };
    const hexToRgb = (hex) => {
      hex = normHex(hex).slice(1);
      return {r:parseInt(hex.slice(0,2),16), g:parseInt(hex.slice(2,4),16), b:parseInt(hex.slice(4,6),16)};
    };
    const rgbToHex = (r,g,b) => '#'+[r,g,b].map(x=>clamp(Math.round(x),0,255).toString(16).padStart(2,'0')).join('').toUpperCase();
    
    // RGB to HSL conversion
    function rgbToHsl(r, g, b) {
      r /= 255; g /= 255; b /= 255;
      const max = Math.max(r, g, b), min = Math.min(r, g, b);
      let h, s, l = (max + min) / 2;
      
      if (max === min) {
        h = s = 0;
      } else {
        const d = max - min;
        s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
        switch(max) {
          case r: h = (g - b) / d + (g < b ? 6 : 0); break;
          case g: h = (b - r) / d + 2; break;
          case b: h = (r - g) / d + 4; break;
        }
        h /= 6;
      }
      return [h, s, l];
    }
    
    // HSL to RGB conversion
    function hslToRgb(h, s, l) {
      let r, g, b;
      
      if (s === 0) {
        r = g = b = l;
      } else {
        const hue2rgb = (p, q, t) => {
          if (t < 0) t += 1;
          if (t > 1) t -= 1;
          if (t < 1/6) return p + (q - p) * 6 * t;
          if (t < 1/2) return q;
          if (t < 2/3) return p + (q - p) * (2/3 - t) * 6;
          return p;
        };
        
        const q = l < 0.5 ? l * (1 + s) : l + s - l * s;
        const p = 2 * l - q;
        r = hue2rgb(p, q, h + 1/3);
        g = hue2rgb(p, q, h);
        b = hue2rgb(p, q, h - 1/3);
      }
      
      return [r * 255, g * 255, b * 255];
    }

    // Generate new random harmonious colors based on base color
    function generateNewHarmoniousColors(baseColor) {
      const baseRgb = hexToRgb(baseColor);
      const [h, s, l] = rgbToHsl(baseRgb.r, baseRgb.g, baseRgb.b);
      
      // Increment seed for different results each time
      state.lastHarmonySeed = (state.lastHarmonySeed + 1) % 1000;
      
      // Get color count
      let count;
      if (DOM.genMode.value === 'random') {
        count = Math.floor(Math.random() * 4) + 2; // 2-5 colors
      } else {
        count = parseInt(DOM.genMode.value);
      }
      
      // Get base position
      const position = DOM.basePosition.value;
      
      const colors = [];
      
      // Generate harmonious colors with different variations each time
      for (let i = 0; i < count; i++) {
        // Use seed to create deterministic but different results
        const seed = state.lastHarmonySeed + i * 123;
        const randomFactor = Math.sin(seed) * 0.5 + 0.5; // 0-1 range
        
        // Create variations by adjusting hue, saturation, and lightness
        let newH = (h + (randomFactor * 0.4)) % 1; // Different hue shift each time
        let newS = clamp(s + (Math.sin(seed * 1.3) * 0.3 - 0.15), 0.3, 0.9);
        let newL = clamp(l + (Math.cos(seed * 0.7) * 0.3 - 0.15), 0.2, 0.8);
        
        // For complementary colors (every other color)
        if (i % 2 === 1 && count > 2) {
          newH = (h + 0.5 + randomFactor * 0.1) % 1; // Complementary with variation
          newL = clamp(l + 0.1 + Math.sin(seed) * 0.1, 0.2, 0.8);
        }
        
        const [r, g, b] = hslToRgb(newH, newS, newL);
        colors.push(rgbToHex(Math.round(r), Math.round(g), Math.round(b)));
      }
      
      // Place base color according to position
      const baseColorHex = normHex(baseColor);
      let finalColors = [...colors];
      
      switch(position) {
        case 'start':
          finalColors = [baseColorHex, ...colors.slice(0, count-1)];
          break;
        case 'end':
          finalColors = [...colors.slice(0, count-1), baseColorHex];
          break;
        case 'middle':
          const middleIndex = Math.floor(count / 2);
          finalColors[middleIndex] = baseColorHex;
          break;
        case 'random':
          const randomIndex = Math.floor(Math.random() * count);
          finalColors[randomIndex] = baseColorHex;
          break;
      }
      
      return finalColors.slice(0, count);
    }

    // Simple Linear Blend
    function blendHex(a,b,t){
      const A=hexToRgb(a), B=hexToRgb(b);
      return rgbToHex(
        A.r+(B.r-A.r)*t,
        A.g+(B.g-A.g)*t,
        A.b+(B.b-A.b)*t
      );
    }

    /* ---------- Gradient Generation ---------- */
    function interpolate(stops, steps, mode='linear'){
      if(stops.length<2) return Array(steps).fill(stops[0]);
      const result = [];
      const segments = stops.length - 1;
      
      for(let s=0; s<segments; s++){
        const c1 = stops[s], c2 = stops[s+1];
        const segSteps = Math.floor(steps/segments) + (s < steps%segments ? 1 : 0);
        
        if(mode === 'lab'){
          // For simplicity, using linear interpolation
          for(let i=0; i<segSteps; i++){
            if (s === segments-1 && i === segSteps-1) {
                result.push(stops[stops.length-1]);
                continue;
            }
            result.push(blendHex(c1, c2, i/segSteps));
          }
        } else {
           for(let i=0; i<segSteps; i++){
             if (s === segments-1 && i === segSteps-1) {
                result.push(stops[stops.length-1]);
                continue;
             }
             result.push(blendHex(c1, c2, i/segSteps));
           }
        }
      }
      while(result.length < steps) result.push(stops[stops.length-1]);
      return result.slice(0,steps);
    }

    /* ---------- Random Color Generator ---------- */
    function generateRandomColors(count = 3) {
      const colors = [];
      for(let i = 0; i < count; i++) {
        const r = Math.floor(Math.random() * 256);
        const g = Math.floor(Math.random() * 256);
        const b = Math.floor(Math.random() * 256);
        colors.push(rgbToHex(r, g, b));
      }
      return colors;
    }

    /* ---------- Presets ---------- */
    const PRESETS = [
      { name: 'Sunset Glow', colors: ['#ff7e5f','#feb47b'] },
      { name: 'Oceanic', colors: ['#00c6ff','#0072ff'] },
      { name: 'Hyper Violet', colors: ['#8e2de2','#4a00e0'] },
      { name: 'Cotton Candy', colors: ['#ec4899','#f97316'] },
      { name: 'Mint Leaf', colors: ['#10b981','#047857'] },
      { name: 'Cyberpunk', colors: ['#ff0066','#8b5cf6','#00d4ff'] },
      { name: 'Midnight', colors: ['#0f172a','#334155'] },
      { name: 'Golden Hour', colors: ['#f5af19','#f12711'] },
      { name: 'Sunrise', colors: ['#ff7e5f','#feb47b','#ffd166'] },
      { name: 'Forest', colors: ['#1a936f','#88d498','#c6dabf'] },
      { name: 'Purple Dream', colors: ['#a463f2','#ff8ce6','#00d4ff'] },
      { name: 'Coral Reef', colors: ['#ff6b6b','#ffa36c','#ffd166'] },
      { name: 'Arctic', colors: ['#a8e6cf','#dcedc1','#ffd3b6'] },
      { name: 'Desert', colors: ['#ffd166','#ef476f','#06d6a0'] },
      { name: 'Galaxy', colors: ['#3a0ca3','#4361ee','#4cc9f0'] },
      { name: 'Autumn', colors: ['#e63946','#f1faee','#a8dadc'] },
      { name: 'Spring', colors: ['#ffafcc','#bde0fe','#a2d2ff'] },
      { name: 'Summer', colors: ['#ffbe0b','#fb5607','#ff006e'] },
      { name: 'Winter', colors: ['#8ecae6','#219ebc','#023047'] },
      { name: 'Neon Lights', colors: ['#ff006e','#8338ec','#3a86ff'] }
    ];

    /* ---------- User Gradients ---------- */
    function saveCurrentGradient() {
      const gradientName = prompt('Enter a name for this gradient:', `My Gradient ${state.userGradients.length + 1}`);
      if (!gradientName) return;
      
      const gradient = {
        name: gradientName,
        colors: [...state.colors],
        date: new Date().toISOString()
      };
      
      state.userGradients.unshift(gradient);
      if (state.userGradients.length > 50) {
        state.userGradients = state.userGradients.slice(0, 50);
      }
      
      localStorage.setItem('luminaUserGradients', JSON.stringify(state.userGradients));
      renderUserGradients();
      showToast(getMessage('gradientSaved'));
    }
    
    function renderUserGradients() {
      DOM.userGradientsGrid.innerHTML = '';
      
      if (state.userGradients.length === 0) {
        const emptyMsg = document.createElement('div');
        emptyMsg.style.gridColumn = '1 / -1';
        emptyMsg.style.textAlign = 'center';
        emptyMsg.style.padding = '20px';
        emptyMsg.style.color = 'var(--text-muted)';
        emptyMsg.textContent = translations[state.language]?.noSavedGradients || 'No saved gradients yet. Create one and click "Save Gradient"!';
        DOM.userGradientsGrid.appendChild(emptyMsg);
        return;
      }
      
      state.userGradients.forEach((gradient, index) => {
        const card = document.createElement('div'); 
        card.className = 'preset-item';
        
        // Create preview with strips
        const prev = document.createElement('div'); 
        prev.className='preset-preview';
        
        // Generate gradient from gradient colors
        const gradientColors = interpolate(gradient.colors, 10, 'linear');
        
        gradientColors.forEach(c => {
          const strip = document.createElement('div');
          strip.className = 'preset-strip';
          strip.style.backgroundColor = c;
          prev.appendChild(strip);
        });
        
        const info = document.createElement('div'); 
        info.className='preset-info';
        info.style.display = 'flex';
        info.style.justifyContent = 'space-between';
        info.style.alignItems = 'center';
        
        const nameSpan = document.createElement('span');
        nameSpan.textContent = gradient.name;
        nameSpan.style.flex = '1';
        nameSpan.style.overflow = 'hidden';
        nameSpan.style.textOverflow = 'ellipsis';
        nameSpan.style.whiteSpace = 'nowrap';
        
        const deleteBtn = document.createElement('button');
        deleteBtn.className = 'btn-icon';
        deleteBtn.innerHTML = 'âœ•';
        deleteBtn.style.fontSize = '0.7rem';
        deleteBtn.style.padding = '4px';
        deleteBtn.title = 'Delete gradient';
        deleteBtn.addEventListener('click', (e) => {
          e.stopPropagation();
          state.userGradients.splice(index, 1);
          localStorage.setItem('luminaUserGradients', JSON.stringify(state.userGradients));
          renderUserGradients();
          showToast('Gradient deleted');
        });
        
        info.appendChild(nameSpan);
        info.appendChild(deleteBtn);
        
        card.appendChild(prev); 
        card.appendChild(info);
        card.onclick = () => {
            state.colors = [...gradient.colors];
            refresh();
            toggleModal('presetsModal', false);
            showToast(`Applied ${gradient.name}`);
        };
        DOM.userGradientsGrid.appendChild(card);
      });
    }
    
    function clearSavedGradients() {
      if (confirm('Are you sure you want to clear all saved gradients?')) {
        state.userGradients = [];
        localStorage.removeItem('luminaUserGradients');
        renderUserGradients();
        showToast('All saved gradients cleared');
      }
    }

    /* ---------- Rendering & UI ---------- */
    function renderStops(){
      DOM.colorList.innerHTML = '';
      state.colors.forEach((color, i) => {
        const row = document.createElement('div'); row.className = 'color-row';
        
        // Preview/Picker
        const prev = document.createElement('div'); prev.className = 'color-preview';
        prev.style.backgroundColor = color;
        const input = document.createElement('input'); input.type='color'; input.className='color-picker-trigger'; input.value=color;
        input.addEventListener('input', e => updateStop(i, e.target.value));
        prev.appendChild(input);
        
        // Hex Text
        const text = document.createElement('input'); text.type='text'; text.className='hex-input'; text.value=color;
        text.style.width='90px';
        text.addEventListener('change', e => updateStop(i, e.target.value));
        
        // Actions
        const actions = document.createElement('div'); actions.style.marginLeft='auto'; actions.style.display='flex'; actions.style.gap='4px';
        
        if(i > 0) {
            const up = document.createElement('button'); up.className='btn-icon'; up.innerHTML='â†‘';
            up.onclick = () => swap(i, i-1);
            actions.appendChild(up);
        }
        if(i < state.colors.length-1) {
            const down = document.createElement('button'); down.className='btn-icon'; down.innerHTML='â†“';
            down.onclick = () => swap(i, i+1);
            actions.appendChild(down);
        }
        
        const del = document.createElement('button'); del.className='btn-icon'; del.innerHTML='âœ•';
        del.onclick = () => removeStop(i);
        if(state.colors.length <= 2) del.disabled = true;
        
        actions.appendChild(del);
        
        row.appendChild(prev);
        row.appendChild(text);
        row.appendChild(actions);
        DOM.colorList.appendChild(row);
      });
    }

    function updateStop(idx, val){ state.colors[idx] = normHex(val); refresh(); }
    function removeStop(idx){ if(state.colors.length>2) { state.colors.splice(idx,1); refresh(); } else showToast(state.language === 'ar' ? "Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰ Ù„ÙˆÙ†ÙŠÙ† Ù…Ø·Ù„ÙˆØ¨" : "Minimum 2 colors required"); }
    function swap(i,j){ [state.colors[i],state.colors[j]] = [state.colors[j],state.colors[i]]; refresh(); }

    function refresh(){
      renderStops();
      
      // Update config inputs
      DOM.stepsVal.textContent = state.steps;
      DOM.stepsSlider.value = state.steps;

      // Generate
      state.generated = interpolate(state.colors, state.steps, state.vivid?'lab':'linear');
      
      // Visuals - Update preview box with strips
      const css = getGradientCSS();
      DOM.cssText.textContent = css.length > 50 ? css.substring(0,47)+'...' : css;
      
      // Update preview box with strips
      DOM.preview.innerHTML = '';
      state.generated.forEach(c => {
        const strip = document.createElement('div'); 
        strip.className = 'preview-strip';
        strip.style.backgroundColor = c;
        strip.setAttribute('data-color', c);
        strip.title = c;
        strip.onclick = () => copy(c);
        DOM.preview.appendChild(strip);
      });
      
      // Strip
      DOM.strip.innerHTML = '';
      state.generated.forEach(c => {
        const d = document.createElement('div'); d.className='step-unit'; d.style.backgroundColor=c; d.title=c;
        d.onclick = () => copy(c);
        DOM.strip.appendChild(d);
      });
    }

    function getGradientCSS(){
       const stops = state.generated.join(', ');
       return `linear-gradient(to right, ${stops})`;
    }

    /* ---------- Actions ---------- */
    function copy(txt){
      navigator.clipboard.writeText(txt).then(() => showToast(state.language === 'ar' ? "ØªÙ… Ø§Ù„Ù†Ø³Ø® Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø§ÙØ¸Ø©" : "Copied to clipboard"));
    }
    
    function showToast(msg){
      DOM.toast.textContent = msg;
      DOM.toast.classList.add('show');
      setTimeout(()=>DOM.toast.classList.remove('show'), 2000);
    }

    /* ---------- Export ---------- */
    function downloadCSS() {
      const cssContent = `.lumina-gradient {\n  background: ${getGradientCSS()};\n}\n\n/* Generated by Lumina Studio */`;
      const blob = new Blob([cssContent], { type: 'text/css' });
      const url = URL.createObjectURL(blob);
      const link = document.createElement('a');
      link.download = 'lumina-gradient.css';
      link.href = url;
      link.click();
      URL.revokeObjectURL(url);
      showToast(state.language === 'ar' ? 'ØªÙ… ØªÙ†Ø²ÙŠÙ„ Ù…Ù„Ù CSS' : 'CSS file downloaded');
    }
    
    function downloadPNG(){
      // Create canvas with strips instead of gradient
      const w = 800, h = 400;
      const stripWidth = w / state.generated.length;
      
      DOM.canvas.width = w;
      DOM.canvas.height = h;
      const ctx = DOM.canvas.getContext('2d');
      ctx.imageSmoothingEnabled = false;
      
      // Draw each strip
      state.generated.forEach((color, i) => {
        ctx.fillStyle = color;
        ctx.fillRect(i * stripWidth, 0, stripWidth + 1, h); // +1 to avoid gaps
      });
      
      // Create download link
      const link = document.createElement('a');
      link.download = 'lumina-gradient.png';
      link.href = DOM.canvas.toDataURL('image/png', 0.9);
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      
      showToast(state.language === 'ar' ? 'ØªÙ… ØªÙ†Ø²ÙŠÙ„ Ù…Ù„Ù PNG' : 'PNG file downloaded');
    }

    /* ---------- Modal Management ---------- */
    function toggleModal(id, show) {
        const el = document.getElementById(id);
        if(show) { 
          el.classList.add('active'); 
          DOM.body.classList.add('modal-open');
          if (id === 'presetsModal') {
            renderPresets();
            renderUserGradients();
          }
        } else { 
          el.classList.remove('active'); 
          DOM.body.classList.remove('modal-open');
        }
    }

    /* ---------- Init Event Listeners ---------- */
    
    function updateBaseColorPreview() {
      const color = DOM.genBase.value;
      DOM.baseColorPreview.style.backgroundColor = color;
      DOM.genHex.value = color.toUpperCase();
    }
    
    // Language Toggle
    DOM.langToggle.addEventListener('click', (e) => {
      e.stopPropagation();
      DOM.langDropdown.classList.toggle('show');
    });
    
    DOM.langOptions.forEach(option => {
      option.addEventListener('click', () => {
        const lang = option.dataset.lang;
        setLanguage(lang);
        DOM.langDropdown.classList.remove('show');
      });
    });
    
    document.addEventListener('click', () => {
      DOM.langDropdown.classList.remove('show');
    });

    // Generator - Generate New Harmony (different each time)
    DOM.genBase.addEventListener('input', (e) => {
      updateBaseColorPreview();
      DOM.genHex.value = e.target.value.toUpperCase();
    });
    
    DOM.genHex.addEventListener('change', (e) => {
      const color = normHex(e.target.value);
      DOM.genBase.value = color;
      DOM.baseColorPreview.style.backgroundColor = color;
      DOM.genHex.value = color;
    });
    
    DOM.btnGen.addEventListener('click', () => {
       // Generate new harmonious colors based on the current base color
       const baseColor = DOM.genBase.value;
       state.colors = generateNewHarmoniousColors(baseColor);
       refresh();
       showToast(getMessage('paletteGenerated'));
    });

    // Editor
    DOM.btnAdd.addEventListener('click', () => { 
      if(state.colors.length < 10) { 
        // Add a harmonious color when adding new stop
        const baseColor = state.colors[0] || DOM.genBase.value;
        const newColors = generateNewHarmoniousColors(baseColor);
        if (newColors.length > 1) {
          state.colors.push(newColors[1]); 
          refresh(); 
          showToast(state.language === 'ar' ? "ØªÙ… Ø¥Ø¶Ø§ÙØ© Ù„ÙˆÙ† Ù…ØªÙ†Ø§Ø³Ù‚" : "Harmonious color added");
        }
      } else {
        showToast(state.language === 'ar' ? "Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ Ù‡Ùˆ 10 Ø£Ù„ÙˆØ§Ù†" : "Maximum 10 colors allowed");
      }
    });
    
    DOM.btnRandom.addEventListener('click', () => {
      const count = Math.floor(Math.random() * 4) + 2;
      state.colors = generateRandomColors(count);
      refresh();
      showToast(state.language === 'ar' ? `ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ ${count} Ø£Ù„ÙˆØ§Ù† Ø¹Ø´ÙˆØ§Ø¦ÙŠØ©` : `Generated ${count} random colors`);
    });
    
    DOM.stepsSlider.addEventListener('input', e => { 
      state.steps = parseInt(e.target.value); 
      refresh(); 
    });
    
    DOM.stepsDecrease.addEventListener('click', () => {
      if (state.steps > 2) {
        state.steps--;
        DOM.stepsSlider.value = state.steps;
        refresh();
      }
    });
    
    DOM.stepsIncrease.addEventListener('click', () => {
      if (state.steps < 100) {
        state.steps++;
        DOM.stepsSlider.value = state.steps;
        refresh();
      }
    });
    
    DOM.vividFlag.addEventListener('change', e => { state.vivid = e.target.checked; refresh(); });

    // User Gradients
    DOM.saveGradientBtn.addEventListener('click', saveCurrentGradient);
    DOM.clearSavedGradients.addEventListener('click', clearSavedGradients);

    // Modals
    DOM.presetsBtn.addEventListener('click', () => toggleModal('presetsModal', true));
    DOM.breakdownBtn.addEventListener('click', () => {
        DOM.breakGrid.innerHTML = '';
        state.generated.forEach(c => {
            const b = document.createElement('div'); 
            b.style.height='40px'; 
            b.style.background=c; 
            b.style.borderRadius='4px'; 
            b.style.cursor='pointer';
            b.title = c;
            b.onclick = () => copy(c);
            DOM.breakGrid.appendChild(b);
        });
        toggleModal('breakdownModal', true);
    });

    document.querySelectorAll('.close-modal, .close-breakdown, .modal-overlay').forEach(el => {
       el.addEventListener('click', (e) => {
          if(el === e.target || el.classList.contains('close-modal') || el.classList.contains('close-breakdown')) {
             document.querySelectorAll('.modal-overlay').forEach(m => m.classList.remove('active'));
             DOM.body.classList.remove('modal-open');
          }
       });
    });

    // Render Presets
    function renderPresets(){
        DOM.presetsGrid.innerHTML = '';
        PRESETS.forEach(p => {
           const card = document.createElement('div'); 
           card.className = 'preset-item';
           
           const prev = document.createElement('div'); 
           prev.className='preset-preview';
           
           const gradientColors = interpolate(p.colors, 10, 'linear');
           
           gradientColors.forEach(c => {
             const strip = document.createElement('div');
             strip.className = 'preset-strip';
             strip.style.backgroundColor = c;
             prev.appendChild(strip);
           });
           
           const info = document.createElement('div'); 
           info.className='preset-info'; 
           info.textContent = p.name;
           
           card.appendChild(prev); 
           card.appendChild(info);
           card.onclick = () => {
               state.colors = [...p.colors];
               refresh();
               toggleModal('presetsModal', false);
               showToast(`Applied ${p.name}`);
           };
           DOM.presetsGrid.appendChild(card);
        });
    }

    // Export Menu
    DOM.exportToggle.addEventListener('click', e => { e.stopPropagation(); DOM.exportMenu.classList.toggle('show'); });
    document.addEventListener('click', () => DOM.exportMenu.classList.remove('show'));
    
    DOM.actions.css.onclick = () => copy(getGradientCSS());
    DOM.actions.tw.onclick = () => copy(`bg-gradient-to-r from-[${state.colors[0]}] to-[${state.colors[state.colors.length-1]}]`);
    DOM.actions.dlCss.onclick = downloadCSS;
    DOM.actions.dlPng.onclick = downloadPNG;
    DOM.cssTrigger.onclick = () => copy(getGradientCSS());

    // Theme
    DOM.themeToggle.addEventListener('click', () => {
        state.theme = state.theme==='dark'?'light':'dark';
        document.body.setAttribute('data-theme', state.theme);
    });

    // Start
    refresh();
    updateBaseColorPreview();
    renderUserGradients();

function applyAutoLanguage() {
    // 1. Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù„ØºØ© Ø§Ù„Ù…ØªØµÙØ­ (Ù…Ø«Ù„Ø§Ù‹ "ar-SA" Ø£Ùˆ "en-US")
    const browserLang = navigator.language || navigator.userLanguage;
    
    // 2. Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø±Ù…Ø² Ø§Ù„Ù„ØºØ© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ (Ø£ÙˆÙ„ Ø­Ø±ÙÙŠÙ†ØŒ Ù…Ø«Ù„Ø§Ù‹ "ar")
    const primaryLang = browserLang.split('-')[0];

    // 3. Ø§Ù„ØªØ­Ù‚Ù‚: Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ù„ØºØ© Ù…ÙˆØ¬ÙˆØ¯Ø© ÙÙŠ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªØ±Ø¬Ù…Ø§Øª Ù„Ø¯ÙŠÙƒ Ø§Ø³ØªØ®Ø¯Ù…Ù‡Ø§ØŒ 
    // ÙˆØ¥Ù„Ø§ Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© 'en' ÙƒØ®ÙŠØ§Ø± ØªÙ„Ù‚Ø§Ø¦ÙŠ
    const selectedLang = translations[primaryLang] ? primaryLang : 'en';

    // 4. Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ ÙˆØ¸ÙŠÙØ© ØªØºÙŠÙŠØ± Ø§Ù„Ù„ØºØ© Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø© ÙÙŠ ÙƒÙˆØ¯Ùƒ Ø§Ù„Ø£ØµÙ„ÙŠ
    setLanguage(selectedLang); // ØªÙ… Ø§Ù„ØªØºÙŠÙŠØ± Ù…Ù† changeLanguage Ø¥Ù„Ù‰ setLanguage
}

// 5. ØªÙ†ÙÙŠØ° Ø§Ù„Ø¯Ø§Ù„Ø© ÙÙˆØ± ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
document.addEventListener('DOMContentLoaded', applyAutoLanguage);
  </script>
</body>
</html>
